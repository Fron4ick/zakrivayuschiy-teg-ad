/* Анимация кнопки лайк с наслоением SVG изображений */

/* Базовая иконка лайка */
.like-icon {
    display: block;
    width: 39px;
    height: 36px;
    position: relative;
    background-image: url('../svg/like_empty.svg');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    transition: none;
}

/* Псевдоэлементы для наслоения изображений */
.like-icon::before,
.like-icon::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0s;
}

/* Состояние: NOT LIKED */

/* Hover: 0-0.5s показываем cross_dark */
.like-icon:not(.is-liked):hover::before {
    background-image: url('../svg/cross_dark.svg');
    opacity: 1;
    animation: hover-first-stage 0.5s forwards;
}

@keyframes hover-first-stage {
    0% { opacity: 1; }
    99.99% { opacity: 1; }
    100% { opacity: 0; }
}

/* Hover: >0.5s показываем like_final_dark */
.like-icon:not(.is-liked):hover::after {
    background-image: url('../svg/like_final_dark.svg');
    opacity: 0;
    animation: hover-second-stage 0.5s 0.5s forwards;
}

@keyframes hover-second-stage {
    0% { opacity: 0; }
    1% { opacity: 1; }
    100% { opacity: 1; }
}

/* Active (mousedown): 0-0.5s показываем cross_red */
.like-icon:not(.is-liked):active::before {
    background-image: url('../svg/cross_red.svg');
    opacity: 1;
    animation: active-first-stage 0.5s forwards;
}

@keyframes active-first-stage {
    0% { opacity: 1; }
    99.99% { opacity: 1; }
    100% { opacity: 0; }
}

/* Active (mousedown): >0.5s показываем like_final_red с обводкой like_empty */
.like-icon:not(.is-liked):active::after {
    background-image: url('../svg/like_final_red.svg'), url('../svg/like_empty.svg');
    opacity: 0;
    animation: active-second-stage 0.5s 0.5s forwards;
}

@keyframes active-second-stage {
    0% { opacity: 0; }
    1% { opacity: 1; }
    100% { opacity: 1; }
}

/* Click анимация через класс */
.like-icon.clicking::before {
    animation: click-animation-before 2s forwards;
}

.like-icon.clicking::after {
    animation: click-animation-after 2s forwards;
}

/* Анимация клика - слой ::before */
@keyframes click-animation-before {
    /* 0-0.5s: cross_red */
    0% {
        background-image: url('../svg/cross_red.svg');
        opacity: 1;
    }
    24.99% {
        background-image: url('../svg/cross_red.svg');
        opacity: 1;
    }
    /* 0.5-1.0s: like_final_red */
    25% {
        background-image: url('../svg/like_final_red.svg');
        opacity: 1;
    }
    49.99% {
        background-image: url('../svg/like_final_red.svg');
        opacity: 1;
    }
    /* 1.0-1.5s: like_big */
    50% {
        background-image: url('../svg/like_big.svg');
        opacity: 1;
    }
    74.99% {
        background-image: url('../svg/like_big.svg');
        opacity: 1;
    }
    /* 1.5-2.0s: like_bomb */
    75% {
        background-image: url('../svg/like_bomb.svg');
        opacity: 1;
    }
    99.99% {
        background-image: url('../svg/like_bomb.svg');
        opacity: 1;
    }
    /* >2.0s: скрываем */
    100% {
        opacity: 0;
    }
}

@keyframes click-animation-after {
    0%, 100% {
        opacity: 0;
    }
}

/* Состояние: LIKED */
.like-icon.is-liked {
    background-image: url('../svg/like_final_red.svg');
}

.like-icon.is-liked::before,
.like-icon.is-liked::after {
    opacity: 0;
}

/* Сброс при mousedown на лайкнутой кнопке */
.like-icon.is-liked:active {
    background-image: url('../svg/like_empty.svg');
}

.like-icon.is-liked:active::before,
.like-icon.is-liked:active::after {
    opacity: 0;
    animation: none;
}

/* Убираем эффекты при unhover */
.like-icon:not(:hover)::before,
.like-icon:not(:hover)::after {
    animation: none;
    opacity: 0;
    transition: opacity 0.1s;
}

/* Стили для кнопки */
.card__icon-button {
    background: transparent;
    border: 2px solid transparent;
    padding: 0;
    cursor: pointer;
    height: 38px;
    width: 39px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: border-color 0.3s ease;
}

.card__icon-button:focus {
    outline: none;
}

.card__icon-button:focus-visible {
    border-color: var(--accent-color);
}
